#! /bin/bash

#
# T3/BREEDBASE UTILS SCRIPT
# This script will start the specified utility script with the passed arguments
#

# Path to Utils Directory
BB_UTILS="$BB_HOME"/bin/utils.d

# Parse the arguments
SCRIPT="$1"
ARGS="${@:2}"
if [ -z "$SCRIPT" ]; then
    echo "ERROR: The name of the utility script must be specified!"
    exit 1
fi

# Find matching script
files=$(find "$BB_UTILS" -name "$SCRIPT*.sh")
count=$(echo -n "$files" | grep -c '^')
if [[ $count -eq 0 ]]; then
    echo "ERROR: no matching script found!"
    exit 1
elif [[ $count -gt 1 ]]; then
    echo "ERROR: multiple matching scripts found!"
    exit 1
else
    SCRIPT="$files"
fi


# Call the script
BB_HOME="$BB_HOME" BB_DOCKER_DB_SERVICE="$BB_DOCKER_DB_SERVICE" $(which bash) "$SCRIPT" $ARGS